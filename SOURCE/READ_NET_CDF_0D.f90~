!======================================================================!
SUBROUTINE READ_NET_CDF_0D (datum)
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
! Read a 0D netCDF file value
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
USE MPI    ! Enable access to the Message Passing Interface library of
           ! parallel routines.
USE NETCDF ! Enable access to the library of netCDF routines.
USE SHARED ! Shared variables.
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
INTEGER, INTENT (OUT) :: datum
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
INTEGER :: ncid ! netCDF ID.
INTEGER :: len
CHARACTER (LEN = NF90_MAX_NAME) :: RecordDimName
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
! Open existing netCDF dataset for access.
! NF90_NOWRITE specifies open with read-only access.
!----------------------------------------------------------------------!
CALL CHECK (NF90_OPEN (TRIM(file_name), NF90_NOWRITE, ncid))
!----------------------------------------------------------------------!
CALL CHECK (NF90_INQUIRE_DIMENSION (ncid,3,name=RecordDimName,&
  len=datum))
CALL CHECK (NF90_CLOSE (ncid))
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
CONTAINS
  SUBROUTINE CHECK (status)
    INTEGER, INTENT (IN) :: status

    IF (status /= nf90_noerr) THEN
      PRINT *, TRIM (nf90_strerror(status))
      STOP "Stopped"
    END IF
  END SUBROUTINE CHECK
!----------------------------------------------------------------------!

!----------------------------------------------------------------------!
END SUBROUTINE READ_NET_CDF_0D
!======================================================================!

